!function(a){"use strict";var b=a.prompt,c=a.$,d=a.tinymce;d.PluginManager.add("forminputs",function(a){function d(c){var d=a.selection.getNode(),e=a.dom.create("input",{type:"checkbox"}),f=a.dom.create("label",null,b("Saisir un label pour la case Ã  chocher"));a.dom.setAttrib(f,"contenteditable",!1),a.dom.add(f,e),a.dom.add(d,f),a.nodeChanged()}function e(b){b.preventDefault(),console.log(this,b);var d=c(this),e=!!d.attr("checked"),f=d.clone();console.log("toggle",e,!e),f.attr("checked",!e),f.insertAfter(d),d.remove(),a.nodeChanged(),a.fire("change"),a.fire("SetContent")}function f(){c(":checkbox",a.getDoc()).each(function(){var a=this,b=c(this).parent().get(0);"LABEL"!==b.tagName&&(b=c("<label>"),c(a).wrap(b)),c(b).off("click").on("click",function(b){e.call(a,b)})})}function g(b){function d(){var b=c("input[type=checkbox]",a.getDoc());b.filter(function(){return"LABEL"===c(this).parent()[0].nodeName}).parent().attr("contenteditable",!1),b.filter(function(){return"LABEL"!==c(this).parent()[0].nodeName}).wrap(c("label").attr("contenteditable",!1))}setTimeout(d,200)}var h=function(){function a(a,b){this.timeout=a,this.launched=!1,this.callback=null,void 0===b?this.updateFunction=!0:this.updateFunction=b,console.log("this.updateFunction",this.updateFunction)}return a.prototype.updateCallback=function(a){this.callback=a},a.prototype.callCallback=function(){this.launched=!1,this.callback()},a.prototype.callOnce=function(a){var b=this;(this.updateFunction||null===this.callback)&&this.updateCallback(a),this.launched||(this.launched=!0,setTimeout(function(){b.callCallback()},this.timeout))},a}(),i=new h(150);a.on("init NodeChange change SetContent",function(){i.callOnce(f)}),a.on("init",g),a.addMenuItem("forminputs",{separator:"before",text:"Form",context:"insert",menu:[{text:"Checkbox",onclick:d,onPostRender:null}]})})}(window);